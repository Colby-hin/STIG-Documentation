# STIG: WN11-CC-000320  
Users must be notified if a web-based program attempts to install software

---

## Identifiers
- STIG ID: WN11-CC-000320
- Vulnerability ID: V-253412
- Platform: Windows 11 Pro 64-bit (Azure VM)

---

## Finding

The system was configured to allow web-based programs to install software without prompting the user.

The Windows Installer policy value `SafeForScripting` was set to an insecure configuration.

---

## Security Impact

If web-based software installations are not prompted:

- Malicious web content may initiate unauthorized installations.
- Users may be unaware of software deployment attempts.
- Increased risk of drive-by installation attacks.
- System does not meet STIG installation control requirements.

---

## Remediation and Validation

Configured the Windows Installer policy to ensure users are prompted before web-based software installation attempts.

### PowerShell Remediation Script

```powershell
# Ensure registry path exists
New-Item -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Installer" -Force | Out-Null

# Enforce secure configuration (Prompt user)
Set-ItemProperty `
    -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Installer" `
    -Name "SafeForScripting" `
    -Type DWord `
    -Value 0

# Validation Command
Get-ItemProperty `
    -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Installer" `
    -Name "SafeForScripting"
